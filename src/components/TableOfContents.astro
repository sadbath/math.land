---
const { headings } = Astro.props;
const tocHeadings = headings.filter(h => h.depth === 2 || h.depth === 3);
---
<nav class="toc-sidebar">
    <div class="toc-header">
        <a href="/">Putting the "Why?" in Math</a>
    </div>
    <div class="toc-content">
        <h4>In this chapter</h4>
        <ul>
            {tocHeadings.map(heading => (
                    <li class={`depth-${heading.depth}`}>
                        <a href={`#${heading.slug}`}>{heading.text}</a>
                    </li>
            ))}
        </ul>
    </div>
</nav>

<style>
    :root { --toc-width: 300px; }
    .toc-sidebar {
        width: var(--toc-width);
        background-color: #f8f9fa;
        height: 100vh;
        overflow-y: auto;
        padding: 2rem 1.5rem;
        border-left: 1px solid #dee2e6;
        font-family: "IBM Plex Sans", sans-serif;
        position: sticky;
        top: 0;
    }
    .toc-header { font-family: "Phantom Sans", sans-serif; font-weight: 600; margin-bottom: 2rem; }
    .toc-header a { color: #343a40; text-decoration: none; }
    .toc-header a:hover { background: none !important; color: #000; } /* Use !important to override page-wide hover */

    .toc-content h4 { font-size: 0.9em; font-weight: 600; margin: 0 0 0.5rem; color: #495057; }
    .toc-content ul { list-style: none; padding: 0; margin: 0; }
    .toc-content a {
        display: block; padding: 0.25rem 0; font-size: 0.9rem; color: #868e96; text-decoration: none;
        border-left: 2px solid transparent; padding-left: 0.75rem; margin-left: -0.85rem;
    }
    .toc-content a:hover { color: #343a40; background: none !important; }
    .toc-content .depth-3 a { padding-left: 1.75rem; }

    @media (max-width: 900px) {
        .toc-sidebar { display: none; }
    }
</style>